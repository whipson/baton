<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Framework for creating and orchestrating data pipelines in R. Organize, orchestrate, and monitor multiple pipelines in a single project. Use tags to decorate functions with scheduling parameters and configuration.">
<title>Orchestration of Data Pipelines • maestro</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Orchestration of Data Pipelines">
<meta property="og:description" content="Framework for creating and orchestrating data pipelines in R. Organize, orchestrate, and monitor multiple pipelines in a single project. Use tags to decorate functions with scheduling parameters and configuration.">
<meta property="og:image" content="https://whipson.github.io/maestro/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">maestro</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/maestro-1-quick-start.html">Quick Start</a>
    <a class="dropdown-item" href="articles/maestro-2-motivation-concepts.html">Motivation and Concepts</a>
    <a class="dropdown-item" href="articles/maestro-3-use-cases.html">Use Cases</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/whipson/maestro/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="maestro-">maestro 
<a class="anchor" aria-label="anchor" href="#maestro-"></a>
</h1>
</div>
<!-- badges: start -->

<p><code>maestro</code> is a lightweight framework for creating and orchestrating data pipelines in R. If you have several scheduled jobs or pipelines you want to run in R and want to manage them in one project, then <code>maestro</code> is for you!</p>
<p>In <code>maestro</code> you create <strong>pipelines</strong> (functions) and schedule them using <code>roxygen2</code> tags - these are special comments (decorators) above each function. Then you create an <strong>orchestrator</strong> containing <code>maestro</code> functions for scheduling and invoking the pipelines.</p>
<div class="section level2">
<h2 id="pre-release-disclaimer">Pre-release Disclaimer<a class="anchor" aria-label="anchor" href="#pre-release-disclaimer"></a>
</h2>
<p><code>maestro</code> is in early development and its API may undergo changes without notice or deprecation. We encourage people to try it out in real world scenarios, but we do not yet advise using it in critical production environments until it has been thoroughly tested and the API has stabilized.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p><code>maestro</code> is currently pre-release and not available yet on CRAN. It can be installed from Github directly like so:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"https://github.com/whipson/maestro"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="project-setup">Project Setup<a class="anchor" aria-label="anchor" href="#project-setup"></a>
</h2>
<p>A <code>maestro</code> project needs at least two components:</p>
<ol style="list-style-type: decimal">
<li>A collection of R pipelines (functions) that you want to schedule</li>
<li>A single orchestrator script that kicks off the scripts when they’re scheduled to run</li>
</ol>
<p>The project file structure will look like this:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>sample_project</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>├── orchestrator.R</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>└── pipelines</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>    ├── my_etl.R</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>    ├── pipe1.R</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>    └── pipe2.R</span></code></pre></div>
<p>Let’s look at each of these in more detail.</p>
<div class="section level3">
<h3 id="pipelines">Pipelines<a class="anchor" aria-label="anchor" href="#pipelines"></a>
</h3>
<p>A pipeline is task we want to run. This task may involve retrieving data from a source, performing cleaning and computation on the data, then sending it to a destination. <code>maestro</code> is not concerned with what your pipeline does, but rather <em>when</em> you want to run it. Here’s a simple pipeline in <code>maestro</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Example ETL pipeline</span></span>
<span><span class="co">#' @maestroFrequency 1 day</span></span>
<span><span class="co">#' @maestroStartTime 2024-03-25 12:30:00</span></span>
<span><span class="va">my_etl</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="co"># Pretend we're getting data from a source</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Get data"</span><span class="op">)</span></span>
<span>  <span class="va">extracted</span> <span class="op">&lt;-</span> <span class="va">mtcars</span></span>
<span>  </span>
<span>  <span class="co"># Transform</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Transforming"</span><span class="op">)</span></span>
<span>  <span class="va">transformed</span> <span class="op">&lt;-</span> <span class="va">extracted</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>hp_deviation <span class="op">=</span> <span class="va">hp</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">hp</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Load - write to a location</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Writing"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">transformed</span>, file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"transformed_mtcars_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">".csv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>What makes this a <code>maestro</code> pipeline is the use of special <em>roxygen</em>-style comments above the function definition:</p>
<ul>
<li><p><code>#' @maestroFrequency 1 day</code> indicates that this function should execute at a daily frequency.</p></li>
<li><p><code>#' @maestroStartTime 2024-03-25 12:30:00</code> denotes the first time it should run.</p></li>
</ul>
<p>In other words, we’d expect it to run every day at 12:30 starting the 25th of March 2024. There are more <code>maestro</code> tags than these ones and all follow the camelCase convention established by <code>roxygen2</code>.</p>
</div>
<div class="section level3">
<h3 id="orchestrator">Orchestrator<a class="anchor" aria-label="anchor" href="#orchestrator"></a>
</h3>
<p>The orchestrator is a script that checks the schedules of all the pipelines in a <code>maestro</code> project and executes them. The orchestrator also handles global execution tasks such as collecting logs and managing shared resources like global objects and custom functions.</p>
<p>You have the option of using Quarto, RMarkdown, or a straight-up R script for the orchestrator, but the former two have some advantages with respect to deployment on Posit Connect.</p>
<p>A simple orchestrator looks like this:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/whipson/maestro" class="external-link">maestro</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Look through the pipelines directory for maestro pipelines to create a schedule</span></span>
<span><span class="va">schedule_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/build_schedule.html">build_schedule</a></span><span class="op">(</span>pipeline_dir <span class="op">=</span> <span class="st">"pipelines"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Checks which pipelines are due to run and then executes them</span></span>
<span><span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/run_schedule.html">run_schedule</a></span><span class="op">(</span></span>
<span>  <span class="va">schedule_table</span>, </span>
<span>  orch_frequency <span class="op">=</span> <span class="st">"1 day"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><picture><source media="(prefers-color-scheme: dark)" srcset="man/figures/README-/unnamed-chunk-3-dark.svg"><img src="reference/figures/README-/unnamed-chunk-3.svg" width="100%"></source></picture></p>
<p>The function <code><a href="reference/build_schedule.html">build_schedule()</a></code> scours through all the pipelines in the project and builds a schedule. Then <code><a href="reference/run_schedule.html">run_schedule()</a></code> checks each pipeline’s scheduled time against the system time within some margin of rounding and calls those pipelines to run.</p>
</div>
<div class="section level3">
<h3 id="multicore">Multicore<a class="anchor" aria-label="anchor" href="#multicore"></a>
</h3>
<p>If you have several pipelines and/or pipelines that take awhile to run, it can be more efficient to split computation across multiple CPU cores.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/DavisVaughan/furrr" class="external-link">furrr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">multisession</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/run_schedule.html">run_schedule</a></span><span class="op">(</span></span>
<span>  <span class="va">schedule_table</span>,</span>
<span>  cores <span class="op">=</span> <span class="fl">4</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/whipson/maestro/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/whipson/maestro/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing maestro</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Will Hipson <br><small class="roles"> Maintainer, author, copyright holder </small> <a href="https://orcid.org/0000-0002-3931-2189" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Ryan Garnett <br><small class="roles"> Author, contributor, copyright holder </small>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/whipson/maestro/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/whipson/maestro/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://app.codecov.io/gh/whipson/maestro?branch=main" class="external-link"><img src="https://codecov.io/gh/whipson/maestro/branch/main/graph/badge.svg" alt="Codecov test coverage"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Will Hipson, Ryan Garnett.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
